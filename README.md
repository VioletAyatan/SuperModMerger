# ModMergerTool - Techland æ¸¸æˆæ¨¡ç»„åˆå¹¶å·¥å…·

[English](#english) | [ä¸­æ–‡](#ä¸­æ–‡)

## ä¸­æ–‡

### ğŸ“‹ é¡¹ç›®ç®€ä»‹

**ModMergerTool** æ˜¯ä¸€ä¸ªä¸“ä¸º Techland æ¸¸æˆï¼ˆå¦‚ Dying Light ç³»åˆ—ï¼‰è®¾è®¡çš„æ¨¡ç»„æ™ºèƒ½åˆå¹¶å·¥å…·ã€‚å®ƒèƒ½å¤Ÿå°†å¤šä¸ªæ¸¸æˆæ¨¡ç»„æ–‡ä»¶ï¼ˆ.pak æ ¼å¼ï¼‰åˆå¹¶ä¸ºå•ä¸€æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ ANTLR4 è¯­æ³•è§£æå®ç°è„šæœ¬æ–‡ä»¶çš„æ™ºèƒ½å¯¹æ¯”å’Œå†²çªè§£å†³ã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ”€ **æ™ºèƒ½åˆå¹¶**: æ”¯æŒæ— é™æ•°é‡çš„æ¨¡ç»„æ–‡ä»¶åˆå¹¶
- ğŸ”§ **è·¯å¾„ä¿®æ­£ï¼š**åŸºäºåŸç‰ˆæ–‡ä»¶å¯¹modä¸­çš„é”™è¯¯æ–‡ä»¶è·¯å¾„è¿›è¡Œä¿®æ­£
- ğŸ” **å†²çªæ£€æµ‹**: ä½¿ç”¨ ANTLR4 è¿›è¡Œæ·±åº¦è¯­æ³•æ ‘å¯¹æ¯”
- ğŸ‘¤ **ç”¨æˆ·äº¤äº’**: æ¸…æ™°çš„å‘½ä»¤è¡Œç•Œé¢æç¤ºç”¨æˆ·é€‰æ‹©å†²çªè§£å†³æ–¹æ¡ˆ
- ğŸ“Š **è¯¦ç»†ç»Ÿè®¡**: åˆå¹¶åæä¾›è¯¦ç»†çš„å¤„ç†ç»Ÿè®¡ä¿¡æ¯
- ğŸŒ **å›½é™…åŒ–**: åŒæ—¶æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡

### é¡¹ç›®ç®€ä»‹

æˆ‘åšè¿™ä¸ªå·¥å…·çš„åˆè¡·ä¸€å¼€å§‹æ˜¯ä¸ºäº†è§£å†³æˆ‘è‡ªå·±ä½¿ç”¨å¤šä¸ªMODä¹‹é—´çš„å„ç§å†²çªé—®é¢˜ã€‚

æœ€åˆï¼Œæˆ‘å‘ç°äº† **[Unleash The Mods](https://www.nexusmods.com/dyinglightthebeast/mods/140)** è¿™æ¬¾å·¥å…·ï¼Œè™½ç„¶ä¹Ÿå¾ˆä¸é”™ã€‚ä½†æ˜¯æœ‰ä¸€äº›å°é—®é¢˜å’Œä¸€äº›ä¸æ”¯æŒçš„ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±åˆ¶ä½œäº†è¿™æ¬¾å…¨æ–°çš„å·¥å…·ï¼ŒåŸºäºASTè¯­æ³•æ ‘è¿›è¡Œè„šæœ¬åˆ†æï¼Œèƒ½å¤Ÿæ™ºèƒ½è¯†åˆ«ä»£ç ä¸­å†²çªçš„åœ°æ–¹ï¼Œæ™ºèƒ½è¿›è¡Œåˆå¹¶ã€‚å³ä½¿æ˜¯æŠ¥é”™çš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šç ´åæ–‡ä»¶ç»“æ„ã€‚åŒæ—¶ï¼Œä¹Ÿæ„Ÿè°¢**[Unleash The Mods](https://www.nexusmods.com/dyinglightthebeast/mods/140)** è¿™æ¬¾å·¥å…·ä½œè€…çš„è¾›è‹¦ä»˜å‡ºï¼Œæˆ‘çš„ä¸€äº›åˆå¹¶æ€è·¯ä¹Ÿå‚è€ƒäº†ä»–çš„å·¥å…·ã€‚

å› æ­¤æœ¬å·¥å…·çš„åŸºç¡€ä½¿ç”¨æ–¹æ³•ä¹Ÿå®Œå…¨å…¼å®¹ **[Unleash The Mods](https://www.nexusmods.com/dyinglightthebeast/mods/140)** ï¼Œå¹¶ä¸”ä¸éœ€è¦å®‰è£…ä»»ä½•è¿è¡Œåº“ï¼Œç›´æ¥å³å¯ä½¿ç”¨ã€‚

**å·¥å…·æ”¯æŒæ™ºèƒ½åˆå¹¶.scræ–‡ä»¶ .loot .def ç­‰scrè„šæœ¬ç»“æ„çš„æ–‡ä»¶å’Œ.xmlæ–‡ä»¶ï¼Œæ–‡ä»¶è¯­æ³•è§£æå·²ç»å¯¹æ•´ä¸ªåŸç‰ˆdata0.pakæ–‡ä»¶è¿›è¡Œè¿‡å®éªŒï¼Œç¡®ä¿æ²¡æœ‰ä»»ä½•å†²çªã€‚**

### æ”¯æŒçš„æ“ä½œç³»ç»Ÿ

- **Windows 10**
- **Windows 11**
- å…¶ä»–ç‰ˆæœ¬çš„windowsç³»ç»Ÿæœªç»è¿‡æµ‹è¯•ã€‚

### ğŸš€ å¿«é€Ÿå¼€å§‹

#### **1ã€å°†å·¥å…·æ”¾åˆ°å›°å…½æ ¹ç›®å½•/ph_ftç›®å½•ä¸‹ï¼Œå¹¶åˆ›å»ºmodsç›®å½•ï¼Œå°†è¦åˆå¹¶çš„modæ”¾å…¥å…¶ä¸­**

 **å‡†å¤‡ mod æ–‡ä»¶ï¼Œmodæ”¯æŒzipã€pakã€7zç­‰æ ¼å¼**

```bash
# ç¤ºä¾‹
Dying Light The Beast\ph_ft\mods
â”œâ”€â”€ mod1.pak
â”œâ”€â”€ mod2.pak
â””â”€â”€ mod3.pak
```

#### 2. è¿è¡Œåˆå¹¶ç¨‹åº
```bash
# åŒå‡»è¿è¡Œåˆå¹¶å·¥å…·
```

#### 3. æŸ¥çœ‹ç»“æœ
åˆå¹¶åçš„modä¼šè¾“å‡ºåˆ°sourceç›®å½•ä¸‹çš„data7.pakæ–‡ä»¶ï¼Œå¦‚æœä½ æœ‰data7.pakã€‚æ³¨æ„ï¼Œæ­¤å·¥å…·ä¼šæŠŠæ—§çš„è¦†ç›–æ‰ã€‚

### ğŸ“– æ–‡æ¡£

- ğŸš€ [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICK_START.md) - 5 åˆ†é’Ÿä¸Šæ‰‹
- ğŸ“š [å®Œæ•´å®ç°æŒ‡å—](IMPLEMENTATION_GUIDE.md) - è¯¦ç»†çš„æŠ€æœ¯è¯´æ˜
- ğŸ“‹ [é¡¹ç›®å®ŒæˆæŠ¥å‘Š](PROJECT_COMPLETION_REPORT.md) - é¡¹ç›®ç»†èŠ‚
- âœ… [æœ€ç»ˆé¡¹ç›®æ€»ç»“](FINAL_SUMMARY.md) - å®Œæ•´çš„é¡¹ç›®æˆæœ

### ğŸ’» ç³»ç»Ÿè¦æ±‚

- **Java**: JDK 25 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Windows / Linux / macOS
- **ç£ç›˜ç©ºé—´**: è‡³å°‘ä¸º mod æ–‡ä»¶æ€»å¤§å°çš„ 3 å€

### ğŸ“¦ ç¼–è¯‘å’Œæ„å»º

```bash
# ç¼–è¯‘
mvn clean compile

# æ‰“åŒ…
mvn package -DskipTests

# ç”Ÿæˆçš„æ–‡ä»¶
# - target/ModMergerTool-1.0-SNAPSHOT.jar (æ ‡å‡† JAR)
# - target/ModMergerTool-1.0-SNAPSHOT-all.jar (åŒ…å«æ‰€æœ‰ä¾èµ–)
```

### ğŸ® ä½¿ç”¨ç¤ºä¾‹

#### åŸºæœ¬ç”¨æ³•
```bash
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar
```

#### æŒ‡å®šè¾“å‡ºè·¯å¾„
```bash
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar -o "D:\my_merged_mod.pak"
```

#### æ˜¾ç¤ºå¸®åŠ©
```bash
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar -h
```

### ğŸ”§ å‘½ä»¤è¡Œé€‰é¡¹

```
Usage:
  -o, --output <value>     æŒ‡å®šè¾“å‡º PAK æ–‡ä»¶ä½ç½® (é»˜è®¤: ./merged_mod.pak)
  -b, --base <value>       åŸºå‡†modæ‰€åœ¨çš„ä½ç½® (å¯é€‰)
  -h, --help               æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

### ğŸ“Š ç¤ºä¾‹è¾“å‡º

```
====== Techland Mod Merger ======

ğŸ“¦ Found 3 mod(s) to merge:
  1. data3.pak
  2. data6.pak
  3. data7.pak

ğŸ“‚ Extracting data3.pak...
   âœ“ Extracted 10 files
ğŸ“‚ Extracting data6.pak...
   âœ“ Extracted 2 files
ğŸ“‚ Extracting data7.pak...
   âœ“ Extracted 2472 files

ğŸ”„ Processing files...

ğŸ“¦ Creating merged PAK file...
âœ… Merged PAK created: merged_mod.pak

==================================================
ğŸ“Š Merge Statistics:
  Total files processed: 2484
  âœ“ Merged (no conflicts): 0
  âš ï¸  Merged (with conflicts): 0
  ğŸ“„ Copied: 2484
==================================================

âœ… Merge completed successfully with no conflicts!
```

### âš™ï¸ åˆå¹¶ç­–ç•¥

1. **ç›¸åŒæ–‡ä»¶**: ç›´æ¥å¤åˆ¶ï¼ˆå»é‡ï¼‰
2. **è„šæœ¬æ–‡ä»¶** (.scr): 
   - ä½¿ç”¨ ANTLR4 è§£æä¸ºè¯­æ³•æ ‘
   - é€’å½’å¯¹æ¯”æ¯ä¸ªèŠ‚ç‚¹
   - æ£€æµ‹å‚æ•°å·®å¼‚ï¼ˆå†²çªï¼‰
   - æç¤ºç”¨æˆ·é€‰æ‹©ä¿ç•™ç‰ˆæœ¬
3. **å…¶ä»–æ–‡ä»¶**: ä½¿ç”¨æœ€åä¸€ä¸ª mod çš„ç‰ˆæœ¬

### ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•èµ„æºï¼š

```
test_mods/
â”œâ”€â”€ mod1/jump_parameters.scr
â”œâ”€â”€ mod2/jump_parameters.scr
â”œâ”€â”€ test_mod1.pak
â””â”€â”€ test_mod2.pak
```

### ğŸ¯ é¡¹ç›®ç»“æ„

```
ModMergerTool/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/antlr4/           # ANTLR4 è¯­æ³•å®šä¹‰
â”‚   â”œâ”€â”€ main/java/             # Java æºä»£ç 
â”‚   â””â”€â”€ main/resources/         # èµ„æºæ–‡ä»¶ï¼ˆå›½é™…åŒ–ç­‰ï¼‰
â”œâ”€â”€ mods/                       # è¾“å…¥æ¨¡ç»„ç›®å½•
â”œâ”€â”€ test_mods/                  # æµ‹è¯•æ¨¡ç»„
â”œâ”€â”€ examples/                   # ç¤ºä¾‹è„šæœ¬
â”œâ”€â”€ target/                     # ç¼–è¯‘è¾“å‡º
â”œâ”€â”€ pom.xml                     # Maven é…ç½®
â””â”€â”€ æ–‡æ¡£æ–‡ä»¶

```

### ğŸ”§ æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Java 25+
- **æ„å»º**: Maven 3.9+
- **è§£æ**: ANTLR4 4.13.2
- **å·¥å…·åº“**: Lombok, Hutool
- **å›½é™…åŒ–**: è‡ªå®šä¹‰ i18n æ¨¡å—

### ğŸ“ ä¸»è¦ç±»

- **AppMain**: ä¸»ç¨‹åºå…¥å£
- **ModMergerEngine**: æ ¸å¿ƒåˆå¹¶å¼•æ“
- **PakManager**: PAK æ–‡ä»¶ç®¡ç†
- **ScrFileMerger**: è„šæœ¬æ–‡ä»¶åˆå¹¶å™¨
- **ScrTreeComparator**: è¯­æ³•æ ‘å¯¹æ¯”å™¨
- **ScrConflictResolver**: å†²çªè§£å†³å™¨

### ğŸ“ å­¦ä¹ ä»·å€¼

æœ¬é¡¹ç›®å±•ç¤ºäº†ï¼š
- ANTLR4 çš„é«˜çº§åº”ç”¨
- Java NIO æ–‡ä»¶æ“ä½œ
- ZIP æ–‡ä»¶å¤„ç†
- è®¾è®¡æ¨¡å¼åº”ç”¨
- å›½é™…åŒ–å®ç°

### ğŸ“ å¸¸è§é—®é¢˜

**Q: èƒ½åˆå¹¶å¤šå°‘ä¸ª mod æ–‡ä»¶ï¼Ÿ**  
A: ç†è®ºä¸Šæ— é™åˆ¶ï¼Œç¨‹åºä¼šå¤„ç† `mods` ç›®å½•ä¸­æ‰€æœ‰ .pak æ–‡ä»¶

**Q: åˆå¹¶å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿ**  
A: æ£€æŸ¥ mods ç›®å½•æ˜¯å¦å­˜åœ¨ï¼ŒPAK æ–‡ä»¶æ˜¯å¦æœ‰æ•ˆï¼Œç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³

**Q: å¦‚ä½•è‡ªå®šä¹‰å†²çªè§£å†³æ–¹æ¡ˆï¼Ÿ**  
A: ç›®å‰æ”¯æŒäº¤äº’å¼é€‰æ‹©ï¼Œæœªæ¥ç‰ˆæœ¬å¯èƒ½æ”¯æŒé…ç½®æ–‡ä»¶

### ğŸ“„ è®¸å¯è¯

MIT License

### ğŸ‘¨â€ğŸ’» è´¡çŒ®è€…

- **å¼€å‘**: Ankol
- **æ—¶é—´**: 2025-12-18

---

## English

### ğŸ“‹ Project Overview

**ModMergerTool** is a smart mod merger tool designed for Techland games (such as Dying Light series). It can merge multiple game mod files (.pak format) into a single file, and implement intelligent comparison and conflict resolution of script files through ANTLR4 syntax parsing.

### âœ¨ Features

- ğŸ”€ **Smart Merge**: Support unlimited number of mod file merging
- ğŸ” **Conflict Detection**: Deep syntax tree comparison using ANTLR4
- ğŸ‘¤ **User Interaction**: Clear command-line interface for conflict resolution
- ğŸ“Š **Detailed Statistics**: Comprehensive processing statistics after merging
- ğŸŒ **Internationalization**: Support both Chinese and English
- âš¡ **High Performance**: Process 2000+ files in just 10 seconds

### ğŸš€ Quick Start

#### 1. Prepare mod files
```bash
D:\Projects\ModMergerTool\mods\
â”œâ”€â”€ mod1.pak
â”œâ”€â”€ mod2.pak
â””â”€â”€ mod3.pak
```

#### 2. Run the merger
```bash
cd D:\Projects\ModMergerTool
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar
```

#### 3. Check results
```bash
# Output file location
merged_mod.pak
```

### ğŸ“– Documentation

- ğŸš€ [Quick Start Guide](QUICK_START.md)
- ğŸ“š [Implementation Guide](IMPLEMENTATION_GUIDE.md)
- ğŸ“‹ [Project Report](PROJECT_COMPLETION_REPORT.md)
- âœ… [Final Summary](FINAL_SUMMARY.md)

### ğŸ’» System Requirements

- **Java**: JDK 25 or higher
- **OS**: Windows / Linux / macOS
- **Disk Space**: At least 3x the total mod file size

### ğŸ“¦ Build

```bash
# Compile
mvn clean compile

# Package
mvn package -DskipTests
```

### ğŸ® Usage Examples

```bash
# Basic usage
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar

# Specify output path
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar -o "D:\output.pak"

# Show help
java -jar target/ModMergerTool-1.0-SNAPSHOT-all.jar -h
```

### ğŸ“„ License

MIT License

---

**Last Updated**: 2025-12-23  
**Version**: 1.0-SNAPSHOT  
**Status**: âœ… Production Ready  

**Recent Updates**:
- âœ… Three-way comparison merge logic (based on base MOD)
- âœ… Temporary file caching mechanism, 50-75% performance improvement
- âœ… Complete internationalization support (Chinese & English)
- âœ… Support for .7z format and nested archives
- âœ… Optimized path correction strategy

